{% extends "base.html" %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h1>Schedule</h1>
  {% if can_manage %}
    <a href="{% url 'gym:schedule-create' %}" class="btn btn-success">
      âž• Add Schedule
    </a>
  {% endif %}
</div>

<div class="card mb-4">
  <div class="card-body">
    <form method="get">
      <div class="row">
        <div class="col-md-5">
          {{ search_form.date }}
        </div>
        <div class="col-md-5">
          {{ search_form.workout_name }}
        </div>
        <div class="col-md-2">
          <button type="submit" class="btn btn-primary btn-block">
            Search
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
  <table class="table">
    <thead>
      <tr>
        <th>Workout</th>
        <th>Trainer</th>
        <th>Date & Time</th>
        <th>Available</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>

    {% for schedule in schedule_list %}
      <tr>
        <td>{{ schedule.workout.name }}</td>
        <td>{{ schedule.workout.trainer.user.get_full_name}}</td>
        <td>{{ schedule.start_time|date:"d M Y, H:i"  }}</td>
        <td>
          {{ schedule.capacity|add:"-"|add:schedule.bookings.count }} / {{ schedule.capacity }}
        </td>
        <td>
          <a href="{% url 'gym:schedule-detail' pk=schedule.id %}" class="btn btn-primary btn-sm">
            View Details
          </a>
          {% if can_manage %}
          <a href="{% url 'gym:schedule-update' pk=schedule.id %}"
             class="btn btn-sm btn-warning">
            Edit
          </a>
          <a href="{% url 'gym:schedule-delete' pk=schedule.id %}"
             class="btn btn-sm btn-danger">
            Delete
          </a>
          {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="5">No upcoming classes.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}